{"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;4CAKa;AALb;AAEA;AAGO,MAAM,SAAS;IAClB,MAAM,OAAO,IAAI,CAAA,GAAA,qBAAe,AAAD,EAG5B,CAAC,uBAAuB,CAAC;IAE5B,MAAM,eAAe,KAAK,mBAAmB,CAAC,CAAC,sBAAsB,CAAC;IACtE,MAAM,sBAAsB,KAAK,mBAAmB,CAAC,CAAC,oBAAoB,CAAC;IAG3E,0BAA0B;IAC1B,aAAa,YAAY,CAAC,SAAS;IACnC,aAAa,eAAe,CAAC;IAC7B,aAAa,cAAc,CAAC;IAC5B,oBAAoB,cAAc,CAAC;IACnC,KAAK,cAAc,CAAC;IAEpB,KAAK,YAAY,CAAC,CAAC;QACf,KAAK,QAAQ;QACb,KAAK,WAAW;QAChB,KAAK,sBAAsB,CAAC;QAE5B,IAAI,QAAQ,IAAI,CAAC,QAAQ,KAAK,MAAM,IAAI,CAAC,WAAW,KAAK,IAAI;YACzD,IAAI,QAAQ,IAAI,CAAC,QAAQ,EAAE,WAAW,IAAI,CAAC,WAAW;YACtD,QAAQ,GAAG,CAAC,OAAO;YACnB,MAAM,GAAG,CAAA,GAAA,wBAAgB,AAAD,EAAE,WAAW,CAAC,EAAE;gBACpC,QAAQ;gBACR,SAAS;oBACL,gBAAgB;gBACpB;gBACA,MAAM,KAAK,SAAS,CAAC;oBAAE,OAAO;oBAAO,UAAU;gBAAS;YAC5D,GAAG,IAAI,CAAC,OAAO;gBACX,IAAI,CAAC,KAAK,EAAE,EAAE;oBACV,KAAK,oBAAoB,CAAC;wBACtB,OAAO;oBACX;oBACA,KAAK,cAAc;oBACnB,KAAK,sBAAsB,CAAC;oBAC5B;gBACJ;gBAEA,MAAM,MAAM,MAAM,KAAK,IAAI;gBAC3B,QAAQ,GAAG,CAAC;gBACZ,MAAM,WAAW;oBACb,SAAS,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK;oBACpC,aAAa,IAAI,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,SAAS;oBAClD,YAAY,IAAI,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,QAAQ;oBAChD,SAAS,IAAI,IAAI,CAAC,OAAO,CAAC,YAAY;gBAC1C;gBACA,aAAa,OAAO,CAAC,iBAAiB,KAAK,SAAS,CAAC;gBACrD,KAAK,sBAAsB,CAAC;gBAC5B,CAAA,GAAA,cAAQ,AAAD,EAAE,CAAA,GAAA,kBAAU,AAAD,EAAE,QAAQ;YAChC,GACI,KAAK,CAAC,CAAC;gBACH,KAAK,oBAAoB,CAAC;oBACtB,OAAO,MAAM,OAAO,IAChB;gBACR;gBACA,KAAK,cAAc;gBACnB,KAAK,sBAAsB,CAAC;gBAC5B;YACJ,GACA,OAAO,CAAC;gBACJ,KAAK,UAAU;YACnB;QACR;IACJ;AACJ","sources":["src/modules/auth/signIn.ts"],"sourcesContent":["import { navigate, WFFormComponent } from \"@xatom/core\";\nimport axios from 'axios';\nimport { BACKEND_BASE_URL, USER_PATHS } from \"../../config\";\n// import supabase from \"../supabase\";\n\nexport const signIn = async () => {\n    const form = new WFFormComponent<{\n        email: string;\n        password: string;\n    }>(`[xa-type=\"signin-form\"]`);\n\n    const submitButton = form.getChildAsComponent(`[xa-type=\"signin-btn\"]`);\n    const submitButtonWrapper = form.getChildAsComponent(`.form-button-wrapper`);\n\n\n    // accepted current change\n    submitButton.setAttribute(\"value\", \"Continue\");\n    submitButton.removeAttribute(\"disabled\");\n    submitButton.removeCssClass(\"is-disabled\");\n    submitButtonWrapper.removeCssClass(\"is-disabled\");\n    form.removeCssClass(\"pointer-events-off\");\n\n    form.onFormSubmit((data) => {\n        form.showForm();\n        form.disableForm();\n        form.updateSubmitButtonText(\"Please wait...\");\n\n        if (data && data[\"email\"] !== '' && data[\"password\"] !== '') {\n            let email = data[\"email\"], password = data['password'];\n            console.log(email, password);\n            fetch(`${BACKEND_BASE_URL}/auth/login`, {\n                method: \"POST\",\n                headers: {\n                    'Content-Type': 'application/json', // This tells the server it's JSON\n                },\n                body: JSON.stringify({ email: email, password: password }),\n            }).then(async (data) => {\n                if (!data.ok) {\n                    form.updateTextViaAttrVar({\n                        error: \"Unable to login. Please try again.\"\n                    });\n                    form.showErrorState();\n                    form.updateSubmitButtonText(\"Login\");\n                    return;\n                }\n\n                const res = await data.json();\n                console.log(res)\n                const userInfo = {\n                    \"email\": res.data.session.user.email,\n                    \"firstName\": res.data.user.user_metadata.firstName,\n                    \"lastName\": res.data.user.user_metadata.lastName,\n                    \"token\": res.data.session.access_token\n                }\n                localStorage.setItem('@bw-user-auth', JSON.stringify(userInfo));\n                form.updateSubmitButtonText(\"Redirecting...\");\n                navigate(USER_PATHS.chatDemo);\n            }).\n                catch((error) => {\n                    form.updateTextViaAttrVar({\n                        error: error.message ||\n                            \"Unable to login. Please try again.\"\n                    });\n                    form.showErrorState();\n                    form.updateSubmitButtonText(\"Login\");\n                    return;\n                }).\n                finally(() => {\n                    form.enableForm();\n                });\n        }\n    });\n}"],"names":[],"version":3,"file":"signIn.e51c192a.js.map","sourceRoot":"../"}